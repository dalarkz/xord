<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carte Chasse Qu√©bec - Terres de la Couronne</title>

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />

    <!-- FontAwesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Outfit:wght@500;700&display=swap"
        rel="stylesheet">

    <!-- Leaflet Search CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet-search@2.9.8/dist/leaflet-search.min.css" />

    <!-- PWA Manifest for Mobile Installation -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#4a6741">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Chasse QC">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <div id="app-container">
        <!-- Sidebar / Controls -->
        <div id="sidebar">
            <div class="sidebar-header">
                <h1><i class="fa-solid fa-location-crosshairs"></i> Chasse Qu√©bec</h1>
                <p>Carte Interactive des Terres Publiques</p>
            </div>

            <div class="control-group">
                <h3>Outils</h3>
                <button id="btn-add-pin" class="btn-primary"><i class="fa-solid fa-thumbtack"></i> Ajouter un
                    Rep√®re</button>
                <button id="btn-measure" class="btn-secondary"><i class="fa-solid fa-ruler"></i> Mesurer
                    Distance</button>
                <button id="btn-locate" class="btn-secondary"><i class="fa-solid fa-location-arrow"></i> Ma
                    Position</button>
            </div>

            <div class="control-group">
                <h3>M√©t√©o Locale</h3>
                <div id="weather-widget" style="background: rgba(0,0,0,0.2); padding: 12px; border-radius: 6px;">
                    <div id="weather-loading" style="text-align: center; color: #888;">
                        <i class="fa-solid fa-spinner fa-spin"></i> Chargement...
                    </div>
                    <div id="weather-data" style="display: none;">
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <div>
                                <div style="font-size: 2em; font-weight: bold;" id="weather-temp">--¬∞C</div>
                                <div style="font-size: 0.9em; color: #888;" id="weather-desc">--</div>
                            </div>
                            <div style="font-size: 3em;" id="weather-icon">‚òÄÔ∏è</div>
                        </div>
                        <div style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 10px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span>üí® Vent:</span>
                                <span id="weather-wind">-- km/h</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span>üß≠ Direction:</span>
                                <span id="weather-wind-dir">--</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span>‚òÄÔ∏è Lever/Coucher:</span>
                                <span id="weather-sun" style="font-size: 0.85em;">--</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="control-group">
                <h3>L√©gende</h3>
                <ul class="legend-list">
                    <li><span class="legend-icon crown-land"></span> Terres de la Couronne (R√©el - MFFP)</li>
                    <li><span class="legend-icon zec"></span> ZEC (R√©el - MERN)</li>
                    <li><span class="legend-icon reserve"></span> R√©serves Fauniques (R√©el - MERN)</li>
                </ul>
            </div>

            <div class="control-group">
                <h3>Mes Rep√®res</h3>
                <div id="markers-list" class="markers-list">
                    <p class="empty-state">Aucun rep√®re ajout√©.</p>
                </div>
            </div>

            <div class="instructions">
                <h4>Import de Donn√©es</h4>
                <p>Pour ajouter les vraies zones, importez vos fichiers GeoJSON ou KML ici.</p>
                <label for="file-input" class="file-upload">
                    <i class="fa-solid fa-cloud-arrow-up"></i> Charger Fichier
                </label>
                <input type="file" id="file-input" accept=".geojson,.json,.kml" hidden>
            </div>
        </div>

        <!-- Map Container -->
        <div id="map"></div>
    </div>

    <!-- Modal for Adding Pin -->
    <div id="modal-add-pin" class="modal hidden">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Nouveau Rep√®re</h2>
            <form id="form-add-pin">
                <div class="form-group">
                    <label>Type</label>
                    <select id="pin-type" required>
                        <optgroup label="ü¶å Gibier">
                            <option value="orignal">Orignal</option>
                            <option value="ours">Ours</option>
                            <option value="dindon">Dindon Sauvage</option>
                            <option value="canard">Canard / Sauvagine</option>
                            <option value="cerf">Cerf de Virginie</option>
                            <option value="autre_gibier">Autre Gibier</option>
                        </optgroup>
                        <optgroup label="üèπ √âquipement">
                            <option value="cache">Cache / Stand</option>
                            <option value="camp">Campement</option>
                        </optgroup>
                        <optgroup label="üìç Autres">
                            <option value="piste">Piste / Trace</option>
                            <option value="danger">Danger / Zone Interdite</option>
                        </optgroup>
                    </select>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea id="pin-desc" placeholder="Ex: Orignal m√¢le vu √† 18h..." rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>Photo (optionnel)</label>
                    <input type="file" id="pin-photo" accept="image/*"
                        style="width: 100%; padding: 8px; background: #1a1a1a; color: white; border: 1px solid #444; border-radius: 6px;">
                    <small style="color: #888; font-size: 0.8em;">Max 1 photo, sera compress√©e automatiquement</small>
                    <div id="photo-preview" style="margin-top: 10px; display: none;">
                        <img id="preview-img" style="max-width: 100%; max-height: 150px; border-radius: 6px;">
                    </div>
                </div>
                <button type="submit" class="btn-submit">Enregistrer</button>
            </form>
        </div>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <!-- Leaflet Search -->
    <script src="https://unpkg.com/leaflet-search@2.9.8/dist/leaflet-search.min.js"></script>

    <!-- Omniivore for KML/GeoJSON Support (Optional utility often used, 
         but we'll implement native GeoJSON and basic file reader first 
         or include it if complex parsing is needed. Sticking to native for now for simplicity) -->

    <script src="script.js"></script>
</body>

</html>